{# Complex Jinja2 template demonstrating various features #}
# Configuration generated by Rustible
# Host: {{ inventory_hostname }}
# Environment: {{ environment | default('development') }}

[settings]
{% for key, value in settings.items() %}
{{ key }} = {{ value }}
{% endfor %}

[servers]
{% for server in servers %}
[servers.{{ server.name }}]
host = {{ server.host }}
port = {{ server.port | default(8080) }}
enabled = {{ server.enabled | default(true) | lower }}
{% if server.options is defined %}
options = {{ server.options | join(', ') }}
{% endif %}

{% endfor %}

[users]
{% for user in users | default([]) %}
# User: {{ user.name }}
{% if user.admin %}
{{ user.name }} = admin
{% else %}
{{ user.name }} = user
{% endif %}
{% endfor %}

# Generated at: {{ ansible_date_time.iso8601 | default('unknown') }}
